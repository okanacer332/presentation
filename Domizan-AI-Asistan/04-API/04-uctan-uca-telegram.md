# UÃ§tan Uca AkÄ±ÅŸ: Telegram Bot â†” Gateway

> **DokÃ¼man:** 04-API/04-uctan-uca-telegram.md
> **Son GÃ¼ncelleme:** 5 Åubat 2026
> **AkÄ±ÅŸ Tipi:** Telegram Webhook + Bot KomutlarÄ±

---

## ğŸ¯ Bu DokÃ¼manÄ±n AmacÄ±

Her mÃ¼ÅŸterinin Ã¶zel Telegram bot'unun Gateway ile nasÄ±l iletiÅŸim kurduÄŸunu, webhook yapÄ±sÄ±nÄ± ve tÃ¼m komut akÄ±ÅŸlarÄ±nÄ± aÃ§Ä±klar.

---

## ğŸ“Š Genel Mimari

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        TELEGRAM BOT MÄ°MARÄ°SÄ°                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                      â”‚
â”‚   HER MÃœÅTERÄ° Ä°Ã‡Ä°N AYRI BOT                                                         â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                         â”‚
â”‚                                                                                      â”‚
â”‚   MÃ¼ÅŸteri A: @kaya_smmm_bot     â”€â”                                                  â”‚
â”‚   MÃ¼ÅŸteri B: @abc_muhasebe_bot  â”€â”¼â”€â”€â–¶  Gateway Webhook Endpoint                     â”‚
â”‚   MÃ¼ÅŸteri C: @xyz_mali_bot      â”€â”˜     /v1/webhook/telegram/:licenseKey             â”‚
â”‚                                                                                      â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•    â”‚
â”‚                                                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Telegram API   â”‚     â”‚    GATEWAY      â”‚     â”‚       INTELLIGENCE          â”‚   â”‚
â”‚  â”‚                 â”‚     â”‚                 â”‚     â”‚                             â”‚   â”‚
â”‚  â”‚  Webhook POST   â”‚â”€â”€â”€â”€â–¶â”‚  Route by       â”‚â”€â”€â”€â”€â–¶â”‚  RAG Query                  â”‚   â”‚
â”‚  â”‚                 â”‚     â”‚  License Key    â”‚     â”‚  Reminder CRUD              â”‚   â”‚
â”‚  â”‚                 â”‚â—€â”€â”€â”€â”€â”‚                 â”‚â—€â”€â”€â”€â”€â”‚                             â”‚   â”‚
â”‚  â”‚  sendMessage    â”‚     â”‚  Bot Token per  â”‚     â”‚                             â”‚   â”‚
â”‚  â”‚                 â”‚     â”‚  License        â”‚     â”‚                             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”§ Webhook Kurulumu

### Admin Panel'den Lisans OluÅŸturulduÄŸunda

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        WEBHOOK KURULUM AKIÅI                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                      â”‚
â”‚  1. Admin, lisans oluÅŸtururken Telegram Bot Token girer                             â”‚
â”‚                                                                                      â”‚
â”‚  2. Gateway otomatik olarak webhook ayarlar:                                        â”‚
â”‚                                                                                      â”‚
â”‚     POST https://api.telegram.org/bot<BOT_TOKEN>/setWebhook                         â”‚
â”‚                                                                                      â”‚
â”‚     Body:                                                                            â”‚
â”‚     {                                                                                â”‚
â”‚       "url": "https://api.domizan.com/v1/webhook/telegram/DOMIZAN-PRO5-K4Y4",       â”‚
â”‚       "secret_token": "abc123...webhook_secret...xyz789",                           â”‚
â”‚       "allowed_updates": ["message", "callback_query"],                             â”‚
â”‚       "drop_pending_updates": true                                                  â”‚
â”‚     }                                                                                â”‚
â”‚                                                                                      â”‚
â”‚  3. Telegram, tÃ¼m bot mesajlarÄ±nÄ± bu URL'e POST eder                                â”‚
â”‚                                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ” Webhook Request/Response

### Telegram â†’ Gateway: Mesaj GeldiÄŸinde

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  WEBHOOK REQUEST (Telegram â†’ Gateway)                                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                      â”‚
â”‚  POST https://api.domizan.com/v1/webhook/telegram/DOMIZAN-PRO5-K4Y4                 â”‚
â”‚                                                                                      â”‚
â”‚  Headers:                                                                            â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                                          â”‚
â”‚  Content-Type: application/json                                                      â”‚
â”‚  X-Telegram-Bot-Api-Secret-Token: abc123...webhook_secret...xyz789                  â”‚
â”‚                                                                                      â”‚
â”‚  Body (Telegram Update Object):                                                      â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                     â”‚
â”‚  {                                                                                   â”‚
â”‚    "update_id": 123456789,                                                          â”‚
â”‚    "message": {                                                                      â”‚
â”‚      "message_id": 42,                                                              â”‚
â”‚      "from": {                                                                       â”‚
â”‚        "id": 987654321,                                                             â”‚
â”‚        "is_bot": false,                                                             â”‚
â”‚        "first_name": "Ahmet",                                                       â”‚
â”‚        "last_name": "Kaya",                                                         â”‚
â”‚        "username": "ahmetkaya"                                                      â”‚
â”‚      },                                                                              â”‚
â”‚      "chat": {                                                                       â”‚
â”‚        "id": 987654321,                                                             â”‚
â”‚        "first_name": "Ahmet",                                                       â”‚
â”‚        "last_name": "Kaya",                                                         â”‚
â”‚        "username": "ahmetkaya",                                                     â”‚
â”‚        "type": "private"                                                            â”‚
â”‚      },                                                                              â”‚
â”‚      "date": 1707145200,                                                            â”‚
â”‚      "text": "/brif"                                                                â”‚
â”‚    }                                                                                 â”‚
â”‚  }                                                                                   â”‚
â”‚                                                                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  GATEWAY Ä°ÅLEMLER                                                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                      â”‚
â”‚  1. URL'den license key Ã§Ä±kar: DOMIZAN-PRO5-K4Y4                                    â”‚
â”‚  2. Webhook secret doÄŸrula (X-Telegram-Bot-Api-Secret-Token)                        â”‚
â”‚  3. LisansÄ± bul ve bot token'Ä± Ã§Ã¶z                                                  â”‚
â”‚  4. Telegram user'Ä± license'a baÄŸlÄ± mÄ± kontrol et                                   â”‚
â”‚  5. Komutu iÅŸle                                                                     â”‚
â”‚  6. YanÄ±tÄ± Telegram API ile gÃ¶nder                                                  â”‚
â”‚                                                                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  GATEWAY â†’ TELEGRAM: YanÄ±t GÃ¶nderme                                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                      â”‚
â”‚  POST https://api.telegram.org/bot<decrypted_token>/sendMessage                     â”‚
â”‚                                                                                      â”‚
â”‚  Body:                                                                               â”‚
â”‚  {                                                                                   â”‚
â”‚    "chat_id": 987654321,                                                            â”‚
â”‚    "text": "ğŸ“Š *GÃ¼nlÃ¼k Brif - 5 Åubat 2026*\n\n...",                                â”‚
â”‚    "parse_mode": "Markdown",                                                        â”‚
â”‚    "reply_markup": { ... }                // Opsiyonel inline buttons               â”‚
â”‚  }                                                                                   â”‚
â”‚                                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ’¬ Komut AkÄ±ÅŸlarÄ±

### /start - Ä°lk KayÄ±t

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  /start KOMUTU                                                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                      â”‚
â”‚  KullanÄ±cÄ± MesajÄ±:                                                                   â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                                   â”‚
â”‚  /start                                                                              â”‚
â”‚                                                                                      â”‚
â”‚  Gateway Ä°ÅŸlemleri:                                                                  â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                                 â”‚
â”‚  1. telegram_users tablosunda bu telegram_id var mÄ± kontrol et                      â”‚
â”‚  2. Yoksa bekleyen kayÄ±t olarak ekle (status: pending)                              â”‚
â”‚  3. Admin Panel'e WebSocket bildirimi gÃ¶nder                                        â”‚
â”‚                                                                                      â”‚
â”‚  Bot YanÄ±tÄ± (Yeni KullanÄ±cÄ±):                                                       â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                                                                                â”‚  â”‚
â”‚  â”‚  ğŸ‘‹ Merhaba Ahmet!                                                            â”‚  â”‚
â”‚  â”‚                                                                                â”‚  â”‚
â”‚  â”‚  Domizan AI Asistan'a hoÅŸ geldiniz.                                           â”‚  â”‚
â”‚  â”‚                                                                                â”‚  â”‚
â”‚  â”‚  KaydÄ±nÄ±z alÄ±ndÄ± ve admin onayÄ± bekliyor.                                     â”‚  â”‚
â”‚  â”‚  OnaylandÄ±ÄŸÄ±nda size bildirim gÃ¶ndereceÄŸiz.                                   â”‚  â”‚
â”‚  â”‚                                                                                â”‚  â”‚
â”‚  â”‚  Telegram ID: 987654321                                                       â”‚  â”‚
â”‚  â”‚                                                                                â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                                      â”‚
â”‚  Bot YanÄ±tÄ± (Mevcut KullanÄ±cÄ±):                                                     â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                                                                                â”‚  â”‚
â”‚  â”‚  ğŸ‘‹ Tekrar merhaba Ahmet!                                                     â”‚  â”‚
â”‚  â”‚                                                                                â”‚  â”‚
â”‚  â”‚  KullanabileceÄŸiniz komutlar:                                                 â”‚  â”‚
â”‚  â”‚                                                                                â”‚  â”‚
â”‚  â”‚  /brif - GÃ¼nlÃ¼k Ã¶zet                                                          â”‚  â”‚
â”‚  â”‚  /haftalik - HaftalÄ±k rapor                                                   â”‚  â”‚
â”‚  â”‚  /hatÄ±rlat - HatÄ±rlatma oluÅŸtur                                               â”‚  â”‚
â”‚  â”‚  /hatÄ±rlatmalar - Aktif hatÄ±rlatmalar                                         â”‚  â”‚
â”‚  â”‚  /sor - Belgeleriniz hakkÄ±nda soru sorun                                      â”‚  â”‚
â”‚  â”‚  /yardim - TÃ¼m komutlarÄ± gÃ¶ster                                               â”‚  â”‚
â”‚  â”‚                                                                                â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### /brif - GÃ¼nlÃ¼k Ã–zet

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  /brif KOMUTU                                                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                      â”‚
â”‚  KullanÄ±cÄ±: /brif                                                                    â”‚
â”‚                                                                                      â”‚
â”‚  Gateway â†’ Intelligence:                                                             â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                           â”‚
â”‚  POST http://localhost:8001/api/v1/telegram/brief                                   â”‚
â”‚                                                                                      â”‚
â”‚  Headers:                                                                            â”‚
â”‚  X-Internal-Key: <internal_service_key>                                             â”‚
â”‚  X-License-Id: 660e8500-f39c-52e5-b827-557766550001                                 â”‚
â”‚                                                                                      â”‚
â”‚  Body:                                                                               â”‚
â”‚  {                                                                                   â”‚
â”‚    "type": "daily",                                                                  â”‚
â”‚    "telegramUserId": "987654321",                                                   â”‚
â”‚    "date": "2026-02-05"                                                             â”‚
â”‚  }                                                                                   â”‚
â”‚                                                                                      â”‚
â”‚  Intelligence Response:                                                              â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                              â”‚
â”‚  {                                                                                   â”‚
â”‚    "brief": {                                                                        â”‚
â”‚      "date": "2026-02-05",                                                          â”‚
â”‚      "summary": {                                                                    â”‚
â”‚        "documentsProcessed": 47,                                                    â”‚
â”‚        "documentsConfirmed": 45,                                                    â”‚
â”‚        "documentsPending": 2,                                                       â”‚
â”‚        "tokensUsed": 12500,                                                         â”‚
â”‚        "newClients": 0                                                              â”‚
â”‚      },                                                                              â”‚
â”‚      "highlights": [                                                                 â”‚
â”‚        "En Ã§ok belge: ABC LTD (12 belge)",                                          â”‚
â”‚        "2 belge onay bekliyor",                                                     â”‚
â”‚        "Token kullanÄ±mÄ±: %2.5"                                                      â”‚
â”‚      ],                                                                              â”‚
â”‚      "upcomingReminders": [                                                          â”‚
â”‚        { "time": "17:00", "title": "KDV Beyannamesi" }                              â”‚
â”‚      ]                                                                               â”‚
â”‚    }                                                                                 â”‚
â”‚  }                                                                                   â”‚
â”‚                                                                                      â”‚
â”‚  Bot YanÄ±tÄ±:                                                                         â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                                                                                â”‚  â”‚
â”‚  â”‚  ğŸ“Š *GÃ¼nlÃ¼k Brif - 5 Åubat 2026*                                              â”‚  â”‚
â”‚  â”‚                                                                                â”‚  â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                            â”‚  â”‚
â”‚  â”‚                                                                                â”‚  â”‚
â”‚  â”‚  ğŸ“ *Belge Ã–zeti*                                                             â”‚  â”‚
â”‚  â”‚  â€¢ Ä°ÅŸlenen: 47 belge                                                          â”‚  â”‚
â”‚  â”‚  â€¢ Onaylanan: 45 belge âœ…                                                     â”‚  â”‚
â”‚  â”‚  â€¢ Bekleyen: 2 belge â³                                                       â”‚  â”‚
â”‚  â”‚                                                                                â”‚  â”‚
â”‚  â”‚  ğŸ’¡ *Ã–ne Ã‡Ä±kanlar*                                                            â”‚  â”‚
â”‚  â”‚  â€¢ En Ã§ok belge: ABC LTD (12 belge)                                           â”‚  â”‚
â”‚  â”‚  â€¢ 2 belge onay bekliyor                                                      â”‚  â”‚
â”‚  â”‚  â€¢ Token kullanÄ±mÄ±: %2.5                                                      â”‚  â”‚
â”‚  â”‚                                                                                â”‚  â”‚
â”‚  â”‚  â° *BugÃ¼nkÃ¼ HatÄ±rlatmalar*                                                   â”‚  â”‚
â”‚  â”‚  â€¢ 17:00 - KDV Beyannamesi                                                    â”‚  â”‚
â”‚  â”‚                                                                                â”‚  â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                            â”‚  â”‚
â”‚  â”‚  [ğŸ“ˆ DetaylÄ± Rapor]  [âš™ï¸ Ayarlar]                                             â”‚  â”‚
â”‚  â”‚                                                                                â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### /sor - RAG Soru-Cevap

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  /sor KOMUTU (RAG)                                                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                      â”‚
â”‚  KullanÄ±cÄ±: /sor ABC Ltd'nin son 3 aydaki toplam fatura tutarÄ± ne?                  â”‚
â”‚                                                                                      â”‚
â”‚  Gateway â†’ Intelligence:                                                             â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                           â”‚
â”‚  POST http://localhost:8001/api/v1/telegram/rag-query                               â”‚
â”‚                                                                                      â”‚
â”‚  Headers:                                                                            â”‚
â”‚  X-Internal-Key: <internal_service_key>                                             â”‚
â”‚  X-Gemini-Key: <decrypted_customer_key>                                             â”‚
â”‚  X-License-Id: 660e8500-f39c-52e5-b827-557766550001                                 â”‚
â”‚                                                                                      â”‚
â”‚  Body:                                                                               â”‚
â”‚  {                                                                                   â”‚
â”‚    "query": "ABC Ltd'nin son 3 aydaki toplam fatura tutarÄ± ne?",                    â”‚
â”‚    "telegramUserId": "987654321",                                                   â”‚
â”‚    "context": {                                                                      â”‚
â”‚      "currentDate": "2026-02-05"                                                    â”‚
â”‚    }                                                                                 â”‚
â”‚  }                                                                                   â”‚
â”‚                                                                                      â”‚
â”‚  Intelligence Ä°ÅŸlemleri:                                                             â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                           â”‚
â”‚  1. Soruyu embedding'e Ã§evir                                                        â”‚
â”‚  2. ChromaDB'de ilgili belgeleri bul                                                â”‚
â”‚  3. MongoDB'den belge detaylarÄ±nÄ± al                                                â”‚
â”‚  4. Context + Soru â†’ Gemini'ye gÃ¶nder                                               â”‚
â”‚  5. YanÄ±t oluÅŸtur                                                                   â”‚
â”‚                                                                                      â”‚
â”‚  Intelligence Response:                                                              â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                              â”‚
â”‚  {                                                                                   â”‚
â”‚    "answer": "ABC Ltd'nin son 3 aydaki toplam fatura tutarÄ± 45,750.00 TL'dir.",     â”‚
â”‚    "sources": [                                                                      â”‚
â”‚      { "docId": "doc_123", "type": "fatura", "date": "2026-01-15", "amount": 15250 },â”‚
â”‚      { "docId": "doc_124", "type": "fatura", "date": "2025-12-20", "amount": 18500 },â”‚
â”‚      { "docId": "doc_125", "type": "fatura", "date": "2025-11-10", "amount": 12000 } â”‚
â”‚    ],                                                                                â”‚
â”‚    "tokensUsed": 850,                                                               â”‚
â”‚    "confidence": 0.95                                                               â”‚
â”‚  }                                                                                   â”‚
â”‚                                                                                      â”‚
â”‚  Bot YanÄ±tÄ±:                                                                         â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                                                                                â”‚  â”‚
â”‚  â”‚  ğŸ” *Soru:* ABC Ltd'nin son 3 aydaki toplam fatura tutarÄ± ne?                 â”‚  â”‚
â”‚  â”‚                                                                                â”‚  â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                              â”‚  â”‚
â”‚  â”‚                                                                                â”‚  â”‚
â”‚  â”‚  ğŸ“ *YanÄ±t:*                                                                  â”‚  â”‚
â”‚  â”‚  ABC Ltd'nin son 3 aydaki toplam fatura tutarÄ± *45,750.00 TL*'dir.            â”‚  â”‚
â”‚  â”‚                                                                                â”‚  â”‚
â”‚  â”‚  ğŸ“„ *Kaynak Belgeler:*                                                        â”‚  â”‚
â”‚  â”‚  â€¢ 15/01/2026 - Fatura - 15,250 TL                                            â”‚  â”‚
â”‚  â”‚  â€¢ 20/12/2025 - Fatura - 18,500 TL                                            â”‚  â”‚
â”‚  â”‚  â€¢ 10/11/2025 - Fatura - 12,000 TL                                            â”‚  â”‚
â”‚  â”‚                                                                                â”‚  â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                              â”‚  â”‚
â”‚  â”‚  _GÃ¼ven oranÄ±: %95_                                                           â”‚  â”‚
â”‚  â”‚                                                                                â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### /hatÄ±rlat - HatÄ±rlatma OluÅŸturma

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  /hatÄ±rlat KOMUTU                                                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                      â”‚
â”‚  KullanÄ±cÄ±: /hatÄ±rlat yarÄ±n saat 10'da KDV beyannamesi kontrol et                   â”‚
â”‚                                                                                      â”‚
â”‚  Gateway â†’ Intelligence:                                                             â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                           â”‚
â”‚  POST http://localhost:8001/api/v1/telegram/parse-reminder                          â”‚
â”‚                                                                                      â”‚
â”‚  Body:                                                                               â”‚
â”‚  {                                                                                   â”‚
â”‚    "text": "yarÄ±n saat 10'da KDV beyannamesi kontrol et",                           â”‚
â”‚    "currentTime": "2026-02-05T16:30:00+03:00",                                      â”‚
â”‚    "licenseId": "660e8500-f39c-52e5-b827-557766550001",                             â”‚
â”‚    "telegramUserId": "987654321"                                                    â”‚
â”‚  }                                                                                   â”‚
â”‚                                                                                      â”‚
â”‚  Intelligence Response (AI Parse):                                                   â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                  â”‚
â”‚  {                                                                                   â”‚
â”‚    "parsed": {                                                                       â”‚
â”‚      "title": "KDV beyannamesi kontrol et",                                         â”‚
â”‚      "type": "once",                                                                â”‚
â”‚      "scheduledAt": "2026-02-06T10:00:00+03:00",                                    â”‚
â”‚      "humanReadable": "6 Åubat 2026, PerÅŸembe 10:00"                                â”‚
â”‚    },                                                                                â”‚
â”‚    "confidence": 0.98                                                               â”‚
â”‚  }                                                                                   â”‚
â”‚                                                                                      â”‚
â”‚  Gateway PostgreSQL Insert:                                                          â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                        â”‚
â”‚  INSERT INTO reminders (license_id, telegram_user_id, title, reminder_type,         â”‚
â”‚                         scheduled_at, next_run_at, is_active)                       â”‚
â”‚  VALUES ('660e8500...', 'tg_user_id', 'KDV beyannamesi kontrol et',                 â”‚
â”‚          'once', '2026-02-06 10:00:00+03', '2026-02-06 10:00:00+03', true);         â”‚
â”‚                                                                                      â”‚
â”‚  Bot YanÄ±tÄ±:                                                                         â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                                                                                â”‚  â”‚
â”‚  â”‚  âœ… *HatÄ±rlatma oluÅŸturuldu!*                                                 â”‚  â”‚
â”‚  â”‚                                                                                â”‚  â”‚
â”‚  â”‚  ğŸ“‹ KDV beyannamesi kontrol et                                                â”‚  â”‚
â”‚  â”‚  ğŸ“… 6 Åubat 2026, PerÅŸembe                                                    â”‚  â”‚
â”‚  â”‚  â° 10:00                                                                     â”‚  â”‚
â”‚  â”‚  ğŸ” Tek seferlik                                                              â”‚  â”‚
â”‚  â”‚                                                                                â”‚  â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                              â”‚  â”‚
â”‚  â”‚  [âŒ Ä°ptal Et]  [âœï¸ DÃ¼zenle]                                                  â”‚  â”‚
â”‚  â”‚                                                                                â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ Otomatik Bildirimler

### Cron Job: GÃ¼nlÃ¼k Brif (Sabah 09:00)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  OTOMATÄ°K GÃœNLÃœK BRÄ°F                                                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                      â”‚
â”‚  Cron: 0 9 * * * (Her gÃ¼n sabah 09:00)                                              â”‚
â”‚                                                                                      â”‚
â”‚  Gateway Ä°ÅŸlemleri:                                                                  â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                                 â”‚
â”‚                                                                                      â”‚
â”‚  1. Aktif tÃ¼m lisanslarÄ± al                                                         â”‚
â”‚     SELECT * FROM licenses WHERE status = 'active'                                  â”‚
â”‚                                                                                      â”‚
â”‚  2. Her lisans iÃ§in:                                                                 â”‚
â”‚     a. Telegram kullanÄ±cÄ±larÄ±nÄ± al                                                  â”‚
â”‚        SELECT * FROM telegram_users WHERE license_id = ? AND is_active = true      â”‚
â”‚                                                                                      â”‚
â”‚     b. Brif oluÅŸturmak iÃ§in owner/employee rolÃ¼ndeki kullanÄ±cÄ±lara gÃ¶nder           â”‚
â”‚                                                                                      â”‚
â”‚     c. Bot token'Ä± Ã§Ã¶z ve mesaj gÃ¶nder                                              â”‚
â”‚        POST https://api.telegram.org/bot<token>/sendMessage                         â”‚
â”‚                                                                                      â”‚
â”‚  Paralel iÅŸlem iÃ§in: Promise.all + rate limiting (30 msg/sec limit)                 â”‚
â”‚                                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ” GÃ¼venlik Kontrolleri

| Katman | Kontrol | AÃ§Ä±klama |
|--------|---------|----------|
| Telegram â†’ Gateway | Secret Token | X-Telegram-Bot-Api-Secret-Token |
| Gateway | License Route | URL'den license key Ã§Ä±karma |
| Gateway | User Auth | telegram_users tablosunda kontrol |
| Gateway â†’ Intelligence | Internal Key | X-Internal-Key header |
| Gateway â†’ Telegram | Decrypted Token | Lisansa Ã¶zel bot token |

---

## ğŸ“Š Kod Ã–rnekleri

### Gateway Webhook Handler

```typescript
// gateway/src/routes/telegram/webhook.ts

import { Router } from 'express';
import { TelegramService } from '../../services/TelegramService';
import { LicenseService } from '../../services/LicenseService';
import { decryptTelegramToken } from '../../services/CryptoService';

const router = Router();

router.post('/webhook/telegram/:licenseKey', async (req, res) => {
  const { licenseKey } = req.params;
  const secretToken = req.headers['x-telegram-bot-api-secret-token'];
  
  try {
    // 1. LisansÄ± bul
    const license = await LicenseService.findByKey(licenseKey);
    if (!license) {
      return res.status(404).send('Not found');
    }
    
    // 2. Webhook secret doÄŸrula
    if (secretToken !== license.telegramWebhookSecret) {
      return res.status(401).send('Unauthorized');
    }
    
    // 3. Bot token'Ä± Ã§Ã¶z
    const botToken = await decryptTelegramToken(license.telegramBotTokenEncrypted);
    
    // 4. Update'i iÅŸle
    const update = req.body;
    await TelegramService.handleUpdate(update, license, botToken);
    
    // Telegram'a hemen 200 dÃ¶n (async iÅŸleme)
    res.status(200).send('OK');
    
  } catch (error) {
    console.error('Telegram webhook error:', error);
    res.status(500).send('Error');
  }
});

export default router;
```

### Telegram Service

```typescript
// gateway/src/services/TelegramService.ts

import { Telegraf } from 'telegraf';
import { CommandHandlers } from './telegram/CommandHandlers';

export class TelegramService {
  static async handleUpdate(update: any, license: License, botToken: string) {
    // GeÃ§ici bot instance oluÅŸtur
    const bot = new Telegraf(botToken);
    
    const message = update.message;
    if (!message?.text) return;
    
    const telegramId = message.from.id.toString();
    
    // KullanÄ±cÄ±yÄ± doÄŸrula
    const user = await TelegramUserService.findByTelegramId(telegramId, license.id);
    
    // Komut parsing
    const text = message.text;
    
    if (text.startsWith('/start')) {
      await CommandHandlers.handleStart(bot, message, license, user);
    } else if (text.startsWith('/brif')) {
      await CommandHandlers.handleBrif(bot, message, license, user);
    } else if (text.startsWith('/sor ')) {
      const query = text.replace('/sor ', '');
      await CommandHandlers.handleRagQuery(bot, message, license, user, query);
    } else if (text.startsWith('/hatÄ±rlat ')) {
      const reminderText = text.replace('/hatÄ±rlat ', '');
      await CommandHandlers.handleReminder(bot, message, license, user, reminderText);
    } else if (text.startsWith('/hatÄ±rlatmalar')) {
      await CommandHandlers.handleListReminders(bot, message, license, user);
    }
    // ... diÄŸer komutlar
  }
  
  static async sendMessage(botToken: string, chatId: string, text: string, options?: any) {
    const bot = new Telegraf(botToken);
    await bot.telegram.sendMessage(chatId, text, {
      parse_mode: 'Markdown',
      ...options
    });
  }
}
```
